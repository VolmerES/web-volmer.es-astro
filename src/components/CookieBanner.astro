---
---

<div id="cookie-banner" class="fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none opacity-0 transition-opacity duration-300" aria-labelledby="cookie-heading" role="dialog" aria-modal="true">
    <!-- Backdrop (optional, makes it more 'modal' like if desired, currently transparent to allow clicking through specific areas if needed, but we used pointer-events-none on parent) -->
    <!-- Applying pointer-events-auto to the modal content itself -->
    
    <div class="pointer-events-auto w-full max-w-lg p-6 m-4 bg-dark-bg/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl transform translate-y-4 transition-transform duration-300 sm:translate-y-0 shadow-neon-cyan/10">
        <h2 id="cookie-heading" class="text-xl font-bold text-white mb-2">üç™ Cookies</h2>
        <p class="text-gray-400 text-sm mb-6 leading-relaxed">
            Utilizamos cookies propias y de terceros para mejorar tu experiencia y analizar el tr√°fico. 
            Puedes aceptar o rechazar su uso. Consulta nuestra <a href="/politica-de-cookies" class="text-neon-cyan hover:underline">Pol√≠tica de Cookies</a>.
        </p>
        
        <div class="flex flex-col sm:flex-row gap-3">
            <button id="accept-cookies" class="flex-1 px-6 py-2.5 bg-neon-cyan/10 border border-neon-cyan text-neon-cyan font-bold rounded-lg hover:bg-neon-cyan hover:text-black transition-all shadow-[0_0_15px_rgba(5,217,232,0.2)] hover:shadow-[0_0_20px_rgba(5,217,232,0.5)]">
                Aceptar Todo
            </button>
            <button id="reject-cookies" class="flex-1 px-6 py-2.5 bg-white/5 border border-white/10 text-white font-medium rounded-lg hover:bg-white/10 transition-colors">
                Rechazar
            </button>
        </div>
    </div>
</div>

<script>
    document.addEventListener('astro:page-load', () => {
        const banner = document.getElementById('cookie-banner');
        const acceptBtn = document.getElementById('accept-cookies');
        const rejectBtn = document.getElementById('reject-cookies');
        
        if (!banner || !acceptBtn || !rejectBtn) return;

        // Check if user has already made a choice
        const cookieConsent = localStorage.getItem('cookie-consent');
        
        if (!cookieConsent) {
            // Show banner with a slight delay for smooth entrance
            setTimeout(() => {
                banner.classList.remove('opacity-0', 'pointer-events-none');
                // If there's a transform class for animation, we might want to toggle it too
                // but opacity transition handles simple fade. 
            }, 500);
        }

        const closeBanner = () => {
            banner.classList.add('opacity-0', 'pointer-events-none');
        };

        acceptBtn.addEventListener('click', () => {
            localStorage.setItem('cookie-consent', 'accepted');
            closeBanner();
            // Here you would trigger analytics initialization if needed
        });

        rejectBtn.addEventListener('click', () => {
            localStorage.setItem('cookie-consent', 'rejected');
            closeBanner();
        });
    });

    // Fallback for initial load if view transitions aren't strictly used or first load
    // The astro:page-load event handles both initial and subsequent navigations in Astro 3/4 with ViewTransitions
    // However, if we are in a non-SPA mode for some reason, we might need DOMContentLoaded.
    // Given Layout links ClientRouter, we assume ViewTransitions.
</script>
